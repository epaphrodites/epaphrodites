{% macro ajax(ajaxOptions) %}
<script>$(document).ready(function() {const formSelector = "{{ ajaxOptions.form | default('') | escape('js') }}";const submitSelector = "{{ ajaxOptions.submit | default('') | escape('js') }}";const messageSelector = "{{ ajaxOptions.msg | escape('js') }}"; $(document).on('submit', formSelector, function(event) { event.preventDefault(); sendAjaxRequest(); }); $(document).on('click', submitSelector, function() { sendAjaxRequest(); }); function sendAjaxRequest() { var param = {}; {% for value in ajaxOptions.value %} var escapedValue = $("#{{ value | escape('js') }}").val(); param["{{ value | escape('js') }}"] = escapedValue ? escapedValue : ''; {% endfor %} $.ajax({ url: "{{ __path(ajaxOptions.url) | default('') | escape('js') }}", type: "{{ ajaxOptions.method | default('POST') | escape('js') }}", data: param, success: function(response) { $(messageSelector).html(response); }, error: function(xhr, status, error) {$(messageSelector).html("An error occurred while submitting the form."); console.error('AJAX Error: ', error);} });}}); </script>
{% endmacro %}